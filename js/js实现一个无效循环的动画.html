<!DOCTYPE html>
<html>
  <head>
    <title>document</title>
    <style>
      div{
        width: 100px;
        height: 100px;
        background: red;
        position: absolute;
        left: 0;
        top: 0;
        zoom: 1;
      }
    </style>
  </head>
  <body>
    <div id="e"></div>
    <script>
      var e = document.getElementById('e')
        var flag = true
        var left = 0;
        // 当前执行时间
        var nowTime = 0;
        // 记录每次动画执行结束时间
        var lastTime = Date.now()
        // 我们自己定义的动画时间差值
        var diffTime = 40;

        function render() {
          if (flag == true) {
            if (left >= 200) {
              flag = false
            }
            e.style.left = `${left++}px`
          } else {
            if (left <= 0) {
              flag = true
            }
            e.style.left = `${left--}px`
          }
        }

        // 一、 setInterval实现

        //这是因为大多数屏幕渲染的时间间隔是每秒60帧。
        // setInterval(function () {
        //   render()
        // }, 1000 / 60)
      

      // 二、requestAnimationFrame实现
      (function animloop() {
        // 记录当前时间
        nowTime = Date.now()
        // 当前时间-上次执行时间如果大于diffTime,那么执行动画，并更新上次执行时间
        if(nowTime-lastTime > diffTime) {
          lastTime = nowTime
          render()
        }
        rafId = window.requestAnimationFrame(animloop)
        // 如果left等于100 停止动画
        if(left == 100) {
          cancelAnimationFrame(rafId)
        }
      })()
    </script>
  </body>
</html>